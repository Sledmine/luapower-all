<h3 id="content-is-unreadable.-open-and-repair">Content is Unreadable. Open and Repair</h3>
<p>Very, very occasionally you may see an Excel warning when opening an <code>xlsxwriter</code> file like:</p>
<blockquote>
<p>Excel could not open file.xlsx because some content is unreadable. Do you want to open and repair this workbook.</p>
</blockquote>
<p>This ominous sounding message is Excel's default warning for any validation error in the XML used for the components of the XLSX file.</p>
<p>If you encounter an issue like this you should open an issue on GitHub with a program to replicate the issue (see below) or send one of the failing output files to the <code class="interpreted-text" role="ref">author</code>.</p>
<h3 id="formulas-displayed-as-name-until-edited">Formulas displayed as <code>#NAME?</code> until edited</h3>
<p>Excel 2010 and 2013 added functions which weren't defined in the original file specification. These functions are referred to as <em>future</em> functions. Examples of these functions are <code>ACOT</code>, <code>CHISQ.DIST.RT</code> , <code>CONFIDENCE.NORM</code>, <code>STDEV.P</code>, <code>STDEV.S</code> and <code>WORKDAY.INTL</code>. The full list is given in the <a href="http://msdn.microsoft.com/en-us/library/dd907480%28v=office.12%29.aspx">MS XLSX extensions documentation on future functions</a>.</p>
<p>When written using <code>write_formula()</code> these functions need to be fully qualified with the <code>_xlfn.</code> prefix as they are shown in the MS XLSX documentation link above. For example:</p>
<pre><code> worksheet:write_formula(&#39;A1&#39;, &#39;=_xlfn.STDEV.S(B1:B10)&#39;)</code></pre>
<h3 id="formula-results-displaying-as-zero-in-non-excel-applications">Formula results displaying as zero in non-Excel applications</h3>
<p>Due to wide range of possible formulas and interdependencies between them, <code>xlsxwriter</code> doesn't, and realistically cannot, calculate the result of a formula when it is written to an XLSX file. Instead, it stores the value 0 as the formula result. It then sets a global flag in the XLSX file to say that all formulas and functions should be recalculated when the file is opened.</p>
<p>This is the method recommended in the Excel documentation and in general it works fine with spreadsheet applications. However, applications that don't have a facility to calculate formulas, such as Excel Viewer, or several mobile applications, will only display the 0 results.</p>
<p>If required, it is also possible to specify the calculated result of the formula using the optional <code>value</code> parameter in <code class="interpreted-text" role="func">write_formula()</code>:</p>
<pre><code> worksheet:write_formula(&#39;A1&#39;, &#39;=2+2&#39;, num_format, 4)</code></pre>
<h3 id="strings-arent-displayed-in-apple-numbers-in-constant_memory-mode">Strings aren't displayed in Apple Numbers in 'constant_memory' mode</h3>
<p>In <code class="interpreted-text" role="func">Workbook</code> <code>'constant_memory'</code> mode <code>xlsxwriter</code> uses an optimisation where cell strings aren't stored in an Excel structure call "shared strings" and instead are written "in-line".</p>
<p>This is a documented Excel feature that is supported by most spreadsheet applications. One known exception is Apple Numbers for Mac where the string data isn't displayed.</p>
<h3 id="images-not-displayed-correctly-in-excel-2001-for-mac-and-non-excel-applications">Images not displayed correctly in Excel 2001 for Mac and non-Excel applications</h3>
<p>Images inserted into worksheets via <code class="interpreted-text" role="func">insert_image</code> may not display correctly in Excel 2011 for Mac and non-Excel applications such as OpenOffice and LibreOffice. Specifically the images may looked stretched or squashed.</p>
<p>This is not specifically an <code>xlsxwriter</code> issue. It also occurs with files created in Excel 2007 and Excel 2010.</p>
