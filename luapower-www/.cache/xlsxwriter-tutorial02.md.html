<h1 id="tutorial2">Tutorial 2: Adding formatting to the XLSX File</h1>
<p>In the previous section we created a simple spreadsheet using Lua and the <code>xlsxwriter</code> module.</p>
<p>This converted the required data into an Excel file but it looked a little bare. In order to make the information clearer we would like to add some simple formatting, like this:</p>
<p><img src="/files/luapower/xlsxwriter/_images/tutorial02.png" /></p>
<p>The differences here are that we have added <strong>Item</strong> and <strong>Cost</strong> column headers in a bold font, we have formatted the currency in the second column and we have made the <strong>Total</strong> string bold.</p>
<p>To do this we can extend our program as follows:</p>
<div class="only">
<p>html</p>
<p>(The significant changes are shown with a red line.)</p>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode lua"><code class="sourceCode lua"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">local</span> Workbook <span class="op">=</span> <span class="fu">require</span> <span class="st">&quot;xlsxwriter.workbook&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">-- Create a workbook and add a worksheet.</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">local</span> workbook  <span class="op">=</span> Workbook<span class="op">:</span>new<span class="op">(</span><span class="st">&quot;Expensese02.xlsx&quot;</span><span class="op">)</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">local</span> worksheet <span class="op">=</span> workbook<span class="op">:</span>add_worksheet<span class="op">()</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">-- Add a bold format to use to highlight cells.</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">local</span> bold <span class="op">=</span> workbook<span class="op">:</span>add_format<span class="op">({</span>bold <span class="op">=</span> <span class="kw">true</span><span class="op">})</span></span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">-- Add a number format for cells with money.</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">local</span> money <span class="op">=</span> workbook<span class="op">:</span>add_format<span class="op">({</span>num_format <span class="op">=</span> <span class="st">&quot;$#,##0&quot;</span><span class="op">})</span></span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">-- Write some data header.</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>worksheet<span class="op">:</span><span class="fu">write</span><span class="op">(</span><span class="st">&quot;A1&quot;</span><span class="op">,</span> <span class="st">&quot;Item&quot;</span><span class="op">,</span> bold<span class="op">)</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>worksheet<span class="op">:</span><span class="fu">write</span><span class="op">(</span><span class="st">&quot;B1&quot;</span><span class="op">,</span> <span class="st">&quot;Cost&quot;</span><span class="op">,</span> bold<span class="op">)</span></span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">-- Some data we want to write to the worksheet.</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="kw">local</span> expenses <span class="op">=</span> <span class="op">{</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="op">{</span><span class="st">&quot;Rent&quot;</span><span class="op">,</span> <span class="dv">1000</span><span class="op">},</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>  <span class="op">{</span><span class="st">&quot;Gas&quot;</span><span class="op">,</span>   <span class="dv">100</span><span class="op">},</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="op">{</span><span class="st">&quot;Food&quot;</span><span class="op">,</span>  <span class="dv">300</span><span class="op">},</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>  <span class="op">{</span><span class="st">&quot;Gym&quot;</span><span class="op">,</span>    <span class="dv">50</span><span class="op">},</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="op">}</span></span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co">-- Start from the first cell below the headers.</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="kw">local</span> row <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="kw">local</span> col <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="co">-- Iterate over the data and write it out element by element.</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="cf">for</span> <span class="cn">_</span><span class="op">,</span> expense <span class="kw">in</span> <span class="fu">ipairs</span><span class="op">(</span>expenses<span class="op">)</span> <span class="cf">do</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>  <span class="kw">local</span> item<span class="op">,</span> cost <span class="op">=</span> <span class="fu">unpack</span><span class="op">(</span>expense<span class="op">)</span></span>
<span id="cb1-33"><a href="#cb1-33"></a>  worksheet<span class="op">:</span><span class="fu">write</span><span class="op">(</span>row<span class="op">,</span> col<span class="op">,</span>     item<span class="op">)</span></span>
<span id="cb1-34"><a href="#cb1-34"></a>  worksheet<span class="op">:</span><span class="fu">write</span><span class="op">(</span>row<span class="op">,</span> col <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> cost<span class="op">,</span> money<span class="op">)</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>  row <span class="op">=</span> row <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="cf">end</span></span>
<span id="cb1-37"><a href="#cb1-37"></a></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="co">-- Write a total using a formula.</span></span>
<span id="cb1-39"><a href="#cb1-39"></a>worksheet<span class="op">:</span><span class="fu">write</span><span class="op">(</span>row<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="st">&quot;Total&quot;</span><span class="op">,</span>       bold<span class="op">)</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>worksheet<span class="op">:</span><span class="fu">write</span><span class="op">(</span>row<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;=SUM(B2:B5)&quot;</span><span class="op">,</span> money<span class="op">)</span></span>
<span id="cb1-41"><a href="#cb1-41"></a></span>
<span id="cb1-42"><a href="#cb1-42"></a>workbook<span class="op">:</span><span class="fu">close</span><span class="op">()</span></span></code></pre></div>
<p>The main difference between this and the previous program is that we have added two <code class="interpreted-text" role="ref">Format &lt;Format&gt;</code> objects that we can use to format cells in the spreadsheet.</p>
<p>Format objects represent all of the formatting properties that can be applied to a cell in Excel such as fonts, number formatting, colors and borders. This is explained in more detail in <code class="interpreted-text" role="ref">format</code> and <code class="interpreted-text" role="ref">working_with_formats</code>.</p>
<p>For now we will avoid getting into the details and just use a limited amount of the format functionality to add some simple formatting:</p>
<pre><code> -- Add a bold format to use to highlight cells.
 local bold = workbook:add_format({bold = true})

 -- Add a number format for cells with money.
 local money = workbook:add_format({num_format = &quot;$#,##0&quot;})</code></pre>
<p>We can then pass these formats as an optional third parameter to the <code class="interpreted-text" role="ref">worksheet. &lt;Worksheet&gt;</code><code class="interpreted-text" role="func">write()</code> method to format the data in the cell:</p>
<pre><code> write(row, column, token, [format])</code></pre>
<p>Like this:</p>
<pre><code> worksheet:write(row, 0, &quot;Total&quot;, bold)</code></pre>
<p>Which leads us to another new feature in this program. To add the headers in the first row of the worksheet we used <code class="interpreted-text" role="func">write()</code> like this:</p>
<pre><code> worksheet:write(&quot;A1&quot;, &quot;Item&quot;, bold)
 worksheet:write(&quot;B1&quot;, &quot;Cost&quot;, bold)</code></pre>
<p>So, instead of <code>(row, col)</code> we used the Excel <code>"A1"</code> style notation. See <code class="interpreted-text" role="ref">cell_notation</code> for more details but don't be too concerned about it for now. It is just a little syntactic sugar to help with laying out worksheets.</p>
<p>In the next section we will look at handling more data types.</p>
