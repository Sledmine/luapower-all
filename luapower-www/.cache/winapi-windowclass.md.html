<h2 id="requirewinapi.windowclass"><code>require'winapi.windowclass'</code></h2>
<p>This module implements the <code>Window</code> class for creating top-level windows.</p>
<h2 id="window">Window</h2>
<h3 id="hierarchy">Hierarchy</h3>
<ul>
<li><a href="/winapi.vobject">VObject</a>
<ul>
<li><a href="/winapi.basewindowclass">BaseWindow</a>
<ul>
<li>Window</li>
</ul></li>
</ul></li>
</ul>
<h3 id="initial-fields-and-properties">Initial fields and properties</h3>
<p><strong>NOTE:</strong> in the table below <code>i</code> means initial field, <code>r</code> means property which can be read, <code>w</code> means property which can be set.</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>positioning</strong></td>
<td style="text-align: left;"><strong>irw</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>default</strong></td>
<td style="text-align: left;"><strong>reference</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">x, y</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">frame position</td>
<td style="text-align: left;">CW_USEDEFAULT</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">w, h</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">frame size</td>
<td style="text-align: left;">CW_USEDEFAULT</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>customization</strong></td>
<td style="text-align: left;"><strong>irw</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>default</strong></td>
<td style="text-align: left;"><strong>reference</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">title</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">titlebar</td>
<td style="text-align: left;">’’</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">background</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">background color</td>
<td style="text-align: left;">COLOR_WINDOW</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">cursor</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">default cursor</td>
<td style="text-align: left;">IDC_ARROW</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">icon</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">window’s icon</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">small_icon</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">window’s small icon</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">vscroll</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">vertical scrollbar</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_VSCROLL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hscroll</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">horizontal scrollbar</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_HSCROLL</td>
</tr>
<tr class="even">
<td style="text-align: left;">menu</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">menu bar</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">accelerators</td>
<td style="text-align: left;">rw</td>
<td style="text-align: left;">accelerators</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>state</strong></td>
<td style="text-align: left;"><strong>irw</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>default</strong></td>
<td style="text-align: left;"><strong>reference</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">minimized</td>
<td style="text-align: left;">ir</td>
<td style="text-align: left;">minimized state</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_MINIMIZE</td>
</tr>
<tr class="even">
<td style="text-align: left;">maximized</td>
<td style="text-align: left;">ir</td>
<td style="text-align: left;">maximized state</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_MAXIMIZE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">foreground</td>
<td style="text-align: left;">r</td>
<td style="text-align: left;">foreground state</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">normal_rect</td>
<td style="text-align: left;">rw</td>
<td style="text-align: left;">frame rect in normal state</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">restore_to_maximized</td>
<td style="text-align: left;">rw</td>
<td style="text-align: left;">unminimize to maximized state</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">owner</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">window’s owner</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>behavior</strong></td>
<td style="text-align: left;"><strong>irw</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>default</strong></td>
<td style="text-align: left;"><strong>reference</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">autoquit</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">stop the loop when closed</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">closeable</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">can be closed</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">CS_NOCLOSE</td>
</tr>
<tr class="even">
<td style="text-align: left;">minimizable</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">can be minimized</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_MINIMIZEBOX</td>
</tr>
<tr class="odd">
<td style="text-align: left;">maximizable</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">can be maximized</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_MAXIMIZEBOX</td>
</tr>
<tr class="even">
<td style="text-align: left;">resizeable</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">can be resized</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_SIZEBOX</td>
</tr>
<tr class="odd">
<td style="text-align: left;">activable</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">activate and show on taskbar</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_EX_NOACTIVATE</td>
</tr>
<tr class="even">
<td style="text-align: left;">topmost</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">stay above all windows</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_EX_TOPMOST</td>
</tr>
<tr class="odd">
<td style="text-align: left;">help_button</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">help button</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_EX_CONTEXTHELP</td>
</tr>
<tr class="even">
<td style="text-align: left;">sysmenu</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">system menu</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_SYSMENU</td>
</tr>
<tr class="odd">
<td style="text-align: left;">receive_double_clicks</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">enable double click events</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">CS_DBLCLKS</td>
</tr>
<tr class="even">
<td style="text-align: left;">clip_children</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">clip children</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_CLIPCHILDREN</td>
</tr>
<tr class="odd">
<td style="text-align: left;">clip_siblings</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">clip siblings</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_CLIPSIBLINGS</td>
</tr>
<tr class="even">
<td style="text-align: left;">layered</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">layered mode</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_EX_LAYERED</td>
</tr>
<tr class="odd">
<td style="text-align: left;">own_dc</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">own the DC</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">CS_OWNDC</td>
</tr>
<tr class="even">
<td style="text-align: left;">control_parent</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">recursive tabbing between controls</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_EX_CONTROLPARENT</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taskbar_button</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">force showing on taskbar</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_EX_APPWINDOW</td>
</tr>
<tr class="even">
<td style="text-align: left;">remember_maximized_pos</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">maximize to last known position</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">child</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">(for non-activable tool windows)</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_CHILD</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>framing</strong></td>
<td style="text-align: left;"><strong>irw</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>default</strong></td>
<td style="text-align: left;"><strong>reference</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">border</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">add a border</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_BORDER</td>
</tr>
<tr class="even">
<td style="text-align: left;">frame</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">add a titlebar (needs border)</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_DLGFRAME</td>
</tr>
<tr class="odd">
<td style="text-align: left;">window_edge</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">(needs to be the same as frame)</td>
<td style="text-align: left;">true</td>
<td style="text-align: left;">WS_EX_WINDOWEDGE</td>
</tr>
<tr class="even">
<td style="text-align: left;">dropshadow</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">(for non-movable windows)</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">CS_DROPSHADOW</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tool_window</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">tool window frame</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_EX_TOOLWINDOW</td>
</tr>
<tr class="even">
<td style="text-align: left;">dialog_frame</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">double border and no sysmenu icon</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_EX_DLGMODALFRAME</td>
</tr>
<tr class="odd">
<td style="text-align: left;">transparent</td>
<td style="text-align: left;">irw</td>
<td style="text-align: left;">(use layered instead)</td>
<td style="text-align: left;">false</td>
<td style="text-align: left;">WS_EX_TRANSPARENT</td>
</tr>
</tbody>
</table>
<h3 id="methods">Methods</h3>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>state</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>reference</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">close()</td>
<td style="text-align: left;">destroy the window</td>
<td style="text-align: left;">CloseWindow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">activate()</td>
<td style="text-align: left;">activate the window if the app is active</td>
<td style="text-align: left;">SetActiveWindow</td>
</tr>
<tr class="even">
<td style="text-align: left;">setforeground()</td>
<td style="text-align: left;">activate the window anyway</td>
<td style="text-align: left;">SetForegroundWindow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">minimize([deactivate], [async])</td>
<td style="text-align: left;">minimize (deactivate: true)</td>
<td style="text-align: left;">ShowWindow</td>
</tr>
<tr class="even">
<td style="text-align: left;">maximize(nil, [async])</td>
<td style="text-align: left;">maximize and activate</td>
<td style="text-align: left;">ShowWindow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">shownormal([activate], [async])</td>
<td style="text-align: left;">show in normal state (activate: true)</td>
<td style="text-align: left;">ShowWindow</td>
</tr>
<tr class="even">
<td style="text-align: left;">restore(nil, [async])</td>
<td style="text-align: left;">restore from minimized or maximized state</td>
<td style="text-align: left;">ShowWindow</td>
</tr>
<tr class="odd">
<td style="text-align: left;">set_normal_rect(x, y, w, h)</td>
<td style="text-align: left;">set the normal_rect discretely</td>
<td style="text-align: left;">SetWindowPlacement</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>z-order</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>reference</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left;">send_to_back([rel_to_win])</td>
<td style="text-align: left;">move below other windows/specific window</td>
<td style="text-align: left;">SetWindowPos</td>
</tr>
<tr class="even">
<td style="text-align: left;">bring_to_front([rel_to_win])</td>
<td style="text-align: left;">move above other windows/specific window</td>
<td style="text-align: left;">SetWindowPos</td>
</tr>
</tbody>
</table>
<h3 id="events">Events</h3>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>state</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>reference</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">on_close()</td>
<td style="text-align: left;">was closed</td>
<td style="text-align: left;">WM_CLOSE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_activate()</td>
<td style="text-align: left;">was activated</td>
<td style="text-align: left;">WM_ACTIVATE</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_deactivate()</td>
<td style="text-align: left;">was deactivated</td>
<td style="text-align: left;">WM_ACTIVATE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_activate_app()</td>
<td style="text-align: left;">the app was activated</td>
<td style="text-align: left;">WM_ACTIVATEAPP</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_deactivate_app()</td>
<td style="text-align: left;">the app was deactivated</td>
<td style="text-align: left;">WM_ACTIVATEAPP</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_nc_activate()</td>
<td style="text-align: left;">the non-client area was activated</td>
<td style="text-align: left;">WM_NCACTIVATE</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_nc_deactivate()</td>
<td style="text-align: left;">the non-client area was deactivated</td>
<td style="text-align: left;">WM_NCACTIVATE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_minimizing(x, y)</td>
<td style="text-align: left;">minimizing: return false to prevent</td>
<td style="text-align: left;">SC_MINIMIZE</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_unminimizing()</td>
<td style="text-align: left;">unminimizing: return false to prevent</td>
<td style="text-align: left;">WM_QUERYOPEN</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_maximizing(x, y)</td>
<td style="text-align: left;">maximizing: return false to prevent</td>
<td style="text-align: left;">SC_MAXIMIZE</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_restoring(x, y)</td>
<td style="text-align: left;">unmaximizing: return false to prevent</td>
<td style="text-align: left;">SC_RESTORE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_menu_key(char_code)</td>
<td style="text-align: left;">get the ‘f’ in Alt+F on a ‘&amp;File’ menu</td>
<td style="text-align: left;">SC_KEYMENU</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_get_minmax_info(MINMAXINFO)</td>
<td style="text-align: left;">set the min/max size constraints</td>
<td style="text-align: left;">WM_GETMINMAXINFO</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>system events</strong></td>
<td style="text-align: left;"><strong>description</strong></td>
<td style="text-align: left;"><strong>winapi message</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">on_query_end_session()</td>
<td style="text-align: left;">logging off (return false to prevent)</td>
<td style="text-align: left;">WM_QUERYENDSESSION</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_end_session()</td>
<td style="text-align: left;">logging off (after all apps agreed)</td>
<td style="text-align: left;">WM_ENDSESSION</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_system_color_change()</td>
<td style="text-align: left;">system colors changed</td>
<td style="text-align: left;">WM_SYSCOLORCHANGE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_settings_change()</td>
<td style="text-align: left;">system parameters info changed</td>
<td style="text-align: left;">WM_SETTINGCHANGE</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_device_mode_change()</td>
<td style="text-align: left;">device-mode settings changed</td>
<td style="text-align: left;">WM_DEVMODECHANGE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_fonts_change()</td>
<td style="text-align: left;">installed fonts changed</td>
<td style="text-align: left;">WM_FONTCHANGE</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_time_change()</td>
<td style="text-align: left;">system time changed</td>
<td style="text-align: left;">WM_TIMECHANGE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_spooler_change()</td>
<td style="text-align: left;">spooler’s status changed</td>
<td style="text-align: left;">WM_SPOOLERSTATUS</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_input_language_change()</td>
<td style="text-align: left;">input language changed</td>
<td style="text-align: left;">WM_INPUTLANGCHANGE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">on_user_change()</td>
<td style="text-align: left;">used has logged off</td>
<td style="text-align: left;">WM_USERCHANGED</td>
</tr>
<tr class="even">
<td style="text-align: left;">on_display_change()</td>
<td style="text-align: left;">display resolution changed</td>
<td style="text-align: left;">WM_DISPLAYCHANGE</td>
</tr>
</tbody>
</table>
