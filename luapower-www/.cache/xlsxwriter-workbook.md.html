<h1 id="workbook">The Workbook Class</h1>
<p>The Workbook class is the main class exposed by the <code>xlsxwriter</code> module and it is the only class that you will need to instantiate directly.</p>
<p>The Workbook class represents the entire spreadsheet as you see it in Excel and internally it represents the Excel file as it is written on disk.</p>
<h2 id="constructor">Constructor</h2>
<div class="function">
<p>Workbook:new(filename[,options])</p>
<p>Create a new <code>xlsxwriter</code> Workbook object.</p>
<dl>
<dt>param filename</dt>
<dd><p>The name of the new Excel file to create.</p>
</dd>
<dt>param options</dt>
<dd><p>Optional workbook parameters. See below.</p>
</dd>
<dt>rtype</dt>
<dd><p>A Workbook object.</p>
</dd>
</dl>
</div>
<p>The <code>Workbook:new()</code> constructor is used to create a new Excel workbook with a given filename:</p>
<pre><code> local Workbook = require &quot;xlsxwriter.workbook&quot;

 workbook  = Workbook:new(&quot;filename.xlsx&quot;)
 worksheet = workbook:add_worksheet()

 worksheet:write(0, 0, &quot;Hello Excel&quot;)

 workbook:close()</code></pre>
<p><img src="/files/luapower/xlsxwriter/_images/workbook01.png" /></p>
<p>The constructor options are:</p>
<ul>
<li><p><strong>constant_memory</strong>: Reduces the amount of data stored in memory so that large files can be written efficiently:</p>
<pre><code> workbook = Workbook:new(filename, {constant_memory = true})</code></pre>
<p>Note, in this mode a row of data is written and then discarded when a cell in a new row is added via one of the worksheet <code>write_()</code> methods. Therefore, once this mode is active, data should be written in sequential row order.</p>
<p>See <code class="interpreted-text" role="ref">memory_perf</code> for more details.</p></li>
</ul>
<p>When specifying a filename it is recommended that you use an <code>.xlsx</code> extension or Excel will generate a warning when opening the file.</p>
<h2 id="workbookadd_worksheet">workbook:add_worksheet()</h2>
<div class="function">
<p>add_worksheet([sheetname])</p>
<p>Add a new worksheet to a workbook:</p>
<dl>
<dt>param sheetname</dt>
<dd><p>Optional worksheet name, defaults to Sheet1, etc.</p>
</dd>
<dt>rtype</dt>
<dd><p>A <code class="interpreted-text" role="ref">worksheet &lt;Worksheet&gt;</code> object.</p>
</dd>
</dl>
</div>
<p>The <code>add_worksheet()</code> method adds a new worksheet to a workbook.</p>
<p>At least one worksheet should be added to a new workbook. The <code class="interpreted-text" role="ref">Worksheet &lt;worksheet&gt;</code> object is used to write data and configure a worksheet in the workbook.</p>
<p>The <code>sheetname</code> parameter is optional. If it is not specified the default Excel convention will be followed, i.e. Sheet1, Sheet2, etc.:</p>
<pre><code> worksheet1 = workbook:add_worksheet()          -- Sheet1
 worksheet2 = workbook:add_worksheet(&quot;Foglio2&quot;) -- Foglio2
 worksheet3 = workbook:add_worksheet(&quot;Data&quot;)    -- Data
 worksheet4 = workbook:add_worksheet()          -- Sheet4</code></pre>
<figure>
<img src="/files/luapower/xlsxwriter/_images/workbook02.png" alt="" /><figcaption>image</figcaption>
</figure>
<p>The worksheet name must be a valid Excel worksheet name, i.e. it cannot contain any of the characters <code>[ ] : * ? / \</code> and it must be less than 32 characters.</p>
<p>In addition, you cannot use the same, case insensitive, <code>sheetname</code> for more than one worksheet.</p>
<h2 id="workbookadd_format">workbook:add_format()</h2>
<div class="function">
<p>add_format([properties])</p>
<p>Create a new Format object to formats cells in worksheets.</p>
<dl>
<dt>paramionary properties</dt>
<dd><p>An optional table of format properties.</p>
</dd>
<dt>rtype</dt>
<dd><p>A <code class="interpreted-text" role="ref">Format &lt;Format&gt;</code> object.</p>
</dd>
</dl>
</div>
<p>The <code>add_format()</code> method can be used to create new <code class="interpreted-text" role="ref">Format &lt;Format&gt;</code> objects which are used to apply formatting to a cell. You can either define the properties at creation time via a table of property values or later via method calls:</p>
<pre><code> format1 = workbook:add_format(props) -- Set properties at creation.
 format2 = workbook:add_format()      -- Set properties later.</code></pre>
<p>See the <code class="interpreted-text" role="ref">format</code> and <code class="interpreted-text" role="ref">working_with_formats</code> sections for more details about Format properties and how to set them.</p>
<h2 id="workbookclose">workbook:close()</h2>
<div class="function">
<p>close()</p>
<p>Close the Workbook object and write the XLSX file.</p>
</div>
<p>This should be done for every file.</p>
<blockquote>
<p>workbook:close()</p>
</blockquote>
<p>Currently, there is no implicit <code>close()</code>.</p>
<h2 id="workbookset_properties">workbook:set_properties()</h2>
<div class="function">
<p>set_properties()</p>
<p>Set the document properties such as Title, Author etc.</p>
<dl>
<dt>param properties</dt>
<dd><p>Dictionary of document properties.</p>
</dd>
</dl>
</div>
<p>The <code>set_properties</code> method can be used to set the document properties of the Excel file created by <code>xlsxwriter</code>. These properties are visible when you use the <code>Office Button -&gt; Prepare -&gt; Properties</code> option in Excel and are also available to external applications that read or index windows files.</p>
<p>The properties that can be set are:</p>
<ul>
<li><code>title</code></li>
<li><code>subject</code></li>
<li><code>author</code></li>
<li><code>manager</code></li>
<li><code>company</code></li>
<li><code>category</code></li>
<li><code>keywords</code></li>
<li><code>comments</code></li>
<li><code>status</code></li>
</ul>
<p>The properties are all optional and should be passed in table format as follows:</p>
<pre><code> workbook:set_properties({
     title =    &#39;This is an example spreadsheet&#39;,
     subject =  &#39;With document properties&#39;,
     author =   &#39;John McNamara&#39;,
     manager =  &#39;Dr. Heinz Doofenshmirtz&#39;,
     company =  &#39;of Wolves&#39;,
     category = &#39;Example spreadsheets&#39;,
     keywords = &#39;Sample, Example, Properties&#39;,
     comments = &#39;Created with Lua and the xlsxwriter module&#39;})</code></pre>
<p><img src="/files/luapower/xlsxwriter/_images/doc_properties.png" /></p>
<p>See also <code class="interpreted-text" role="ref">ex_doc_properties</code>.</p>
<h2 id="workbookdefine_name">workbook:define_name()</h2>
<div class="function">
<p>define_name()</p>
<p>Create a defined name in the workbook to use as a variable.</p>
<dl>
<dt>param name</dt>
<dd><p>The defined name.</p>
</dd>
<dt>param formula</dt>
<dd><p>The cell or range that the defined name refers to.</p>
</dd>
</dl>
</div>
<p>This method is used to defined a name that can be used to represent a value, a single cell or a range of cells in a workbook: These defined names can then be used in formulas:</p>
<pre><code> workbook:define_name(&quot;Exchange_rate&quot;, &quot;=0.96&quot;)
 worksheet:write(&quot;B3&quot;, &quot;=Exchange_rate&quot;)</code></pre>
<p><img src="/files/luapower/xlsxwriter/_images/defined_name.png" /></p>
<p>As in Excel a name defined like this is "global" to the workbook and can be referred to from any worksheet:</p>
<pre><code> -- Global workbook name.
 workbook:define_name(&quot;Sales&quot;,         &quot;=Sheet1!$G$1:$H$10&quot;)</code></pre>
<p>It is also possible to define a local/worksheet name by prefixing it with the sheet name using the syntax <code>'sheetname!definedname'</code>:</p>
<pre><code> -- Local worksheet name.
 workbook:define_name(&quot;Sheet2!Sales&quot;, &quot;=Sheet2!$G$1:$G$10&quot;)</code></pre>
<p>If the sheet name contains spaces or special characters you must follow the Excel convention and enclose it in single quotes:</p>
<pre><code> workbook:define_name(&quot;&#39;New Data&#39;!Sales&quot;, &quot;=Sheet2!$G$1:$G$10&quot;)</code></pre>
<p>See also <code class="interpreted-text" role="ref">ex_defined_name</code>.</p>
<h2 id="workbookworksheets">workbook:worksheets()</h2>
<div class="function">
<p>worksheets()</p>
<p>Return a sequence of the worksheet objects in the workbook:</p>
<dl>
<dt>rtype</dt>
<dd><p>A sequence of <code class="interpreted-text" role="ref">worksheet &lt;Worksheet&gt;</code> objects.</p>
</dd>
</dl>
</div>
<p>The <code>worksheets()</code> method returns a table/sequence of the worksheets in a workbook suitable for iteration with <code>ipairs()</code>. This is useful if you want to repeat an operation on each worksheet in a workbook:</p>
<pre><code> for _, worksheet in ipairs(workbook:worksheets()) do
     worksheet:write(&quot;A1&quot;, &quot;Hello&quot;)
 end</code></pre>
