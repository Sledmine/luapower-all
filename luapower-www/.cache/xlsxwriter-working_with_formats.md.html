<h1 id="working_with_formats">Working with Formats</h1>
<p>The methods and properties used to add formatting to a cell are shown in <code class="interpreted-text" role="ref">format</code>. This section provides some additional information about working with formats.</p>
<h2 id="creating-and-using-a-format-object">Creating and using a Format object</h2>
<p>Cell formatting is defined through a <code class="interpreted-text" role="ref">Format object &lt;format&gt;</code>. Format objects are created by calling the workbook <code>add_format()</code> method as follows:</p>
<pre><code> format1 = workbook:add_format()      -- Set properties later.
 format2 = workbook:add_format(props) -- Set properties at creation.</code></pre>
<p>Once a Format object has been constructed and its properties have been set it can be passed as an argument to the worksheet <code>write</code> methods as follows:</p>
<pre><code> worksheet:write       (0, 0, &quot;Foo&quot;, format)
 worksheet:write_string(1, 0, &quot;Bar&quot;, format)
 worksheet:write_number(2, 0, 3,     format)
 worksheet:write_blank (3, 0, &quot;&quot;,    format)</code></pre>
<p>Formats can also be passed to the worksheet <code>set_row()</code> and <code>set_column()</code> methods to define the default formatting properties for a row or column:</p>
<pre><code> worksheet:set_row(0, 18, format)
 worksheet:set_column(&quot;A:D&quot;, 20, format)</code></pre>
<h2 id="format-methods-and-format-properties">Format methods and Format properties</h2>
<p>The following table shows the Excel format categories, the formatting properties that can be applied and the equivalent object method:</p>
<table style="width:98%;">
<colgroup>
<col style="width: 13%" />
<col style="width: 18%" />
<col style="width: 20%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Property</th>
<th style="text-align: left;">Method Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Font</td>
<td style="text-align: left;">Font type</td>
<td style="text-align: left;"><code>font_name</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_font_name()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Font size</td>
<td style="text-align: left;"><code>font_size</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_font_size()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Font color</td>
<td style="text-align: left;"><code>font_color</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_font_color()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Bold</td>
<td style="text-align: left;"><code>bold</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_bold()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Italic</td>
<td style="text-align: left;"><code>italic</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_italic()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Underline</td>
<td style="text-align: left;"><code>underline</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_underline()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Strikeout</td>
<td style="text-align: left;"><code>font_strikeout</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_font_strikeout()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Super/Subscript</td>
<td style="text-align: left;"><code>font_script</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_font_script()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number</td>
<td style="text-align: left;">Numeric format</td>
<td style="text-align: left;"><code>num_format</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_num_format()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Protection</td>
<td style="text-align: left;">Lock cells</td>
<td style="text-align: left;"><code>locked</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_locked()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Hide formulas</td>
<td style="text-align: left;"><code>hidden</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_hidden()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Alignment</td>
<td style="text-align: left;">Horizontal align</td>
<td style="text-align: left;"><code>align</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_align()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Vertical align</td>
<td style="text-align: left;"><code>valign</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_align()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Rotation</td>
<td style="text-align: left;"><code>rotation</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_rotation()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Text wrap</td>
<td style="text-align: left;"><code>text_wrap</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_text_wrap()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Justify last</td>
<td style="text-align: left;"><code>text_justlast</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_text_justlast()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Center across</td>
<td style="text-align: left;"><code>center_across</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_center_across()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Indentation</td>
<td style="text-align: left;"><code>indent</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_indent()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Shrink to fit</td>
<td style="text-align: left;"><code>shrink</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_shrink()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Pattern</td>
<td style="text-align: left;">Cell pattern</td>
<td style="text-align: left;"><code>pattern</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_pattern()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Background color</td>
<td style="text-align: left;"><code>bg_color</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_bg_color()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Foreground color</td>
<td style="text-align: left;"><code>fg_color</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_fg_color()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Border</td>
<td style="text-align: left;">Cell border</td>
<td style="text-align: left;"><code>border</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_border()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Bottom border</td>
<td style="text-align: left;"><code>bottom</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_bottom()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Top border</td>
<td style="text-align: left;"><code>top</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_top()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Left border</td>
<td style="text-align: left;"><code>left</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_left()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Right border</td>
<td style="text-align: left;"><code>right</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_right()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Border color</td>
<td style="text-align: left;"><code>border_color</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_border_color()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Bottom color</td>
<td style="text-align: left;"><code>bottom_color</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_bottom_color()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Top color</td>
<td style="text-align: left;"><code>top_color</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_top_color()</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Left color</td>
<td style="text-align: left;"><code>left_color</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_left_color()</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Right color</td>
<td style="text-align: left;"><code>right_color</code></td>
<td style="text-align: left;"><code class="interpreted-text" role="func">set_right_color()</code></td>
</tr>
</tbody>
</table>
<p>There are two ways of setting Format properties: by using the object interface or by setting the property as a table of key/value pairs in the constructor. For example, a typical use of the object interface would be as follows:</p>
<pre><code> format = workbook:add_format()
 format:set_bold()
 format:set_font_color(&quot;red&quot;)</code></pre>
<p>By comparison the properties can be set by passing a table of properties to the <span class="title-ref">add_format()</span> constructor:</p>
<pre><code> format = workbook:add_format({bold = true, font_color = &quot;red&quot;})</code></pre>
<p>The object method interface is mainly provided for backward compatibility. The key/value interface has proved to be more flexible in real world programs and is the recommended method for setting format properties.</p>
<p>It is also possible, as with any Lua function that takes a table as its only parameter to use the following shorthand syntax:</p>
<blockquote>
<p>format = workbook:add_format{bold = true, font_color = "red"}</p>
</blockquote>
<h2 id="format-colors">Format Colors</h2>
<p>Format property colors are specified using a Html sytle <code>#RRGGBB</code> value or a imited number of named colors:</p>
<pre><code> format1:set_font_color(&quot;#FF0000&quot;)
 format2:set_font_color(&quot;red&quot;)</code></pre>
<p>See <code class="interpreted-text" role="ref">colors</code> for more details.</p>
<h2 id="format-defaults">Format Defaults</h2>
<p>The default Excel 2007+ cell format is Calibri 11 with all other properties off.</p>
<p>In general a format method call without an argument will turn a property on, for example:</p>
<pre><code> format = workbook:add_format()

 format:set_bold()  -- Turns bold on.</code></pre>
<h2 id="modifying-formats">Modifying Formats</h2>
<p>Each unique cell format in an <code>xlsxwriter</code> spreadsheet must have a corresponding Format object. It isn't possible to use a Format with a <code>write()</code> method and then redefine it for use at a later stage. This is because a Format is applied to a cell not in its current state but in its final state. Consider the following example:</p>
<pre><code> format = workbook:add_format({bold - true, font_color = &quot;red&quot;})
 worksheet:write(&quot;A1&quot;, &quot;Cell A1&quot;, format)

 -- Later...
 format:set_font_color(&quot;green&quot;)
 worksheet:write(&quot;B1&quot;, &quot;Cell B1&quot;, format)</code></pre>
<p>Cell A1 is assigned a format which is initially has the font set to the colour red. However, the colour is subsequently set to green. When Excel displays Cell A1 it will display the final state of the Format which in this case will be the colour green.</p>
