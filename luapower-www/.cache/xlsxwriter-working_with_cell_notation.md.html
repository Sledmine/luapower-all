<h1 id="cell_notation">Working with Cell Notation</h1>
<p>Xlsxwriter.lua supports two forms of notation to designate the position of cells: <strong>Row-column</strong> notation and <strong>A1</strong> notation.</p>
<p>Row-column notation uses a zero based index for both row and column while A1 notation uses the standard Excel alphanumeric sequence of column letter and 1-based row. For example:</p>
<pre><code> (0, 0)     -- Row-column notation.
 (&quot;A1&quot;)     -- The same cell in A1 notation.

 (6, 2)     -- Row-column notation.
 (&quot;C7&quot;)     -- The same cell in A1 notation.</code></pre>
<p>Row-column notation is useful if you are referring to cells programmatically:</p>
<pre><code> for row = 0, 5 do
     worksheet:write(row, 0, &quot;Hello&quot;)
 end</code></pre>
<p>A1 notation is useful for setting up a worksheet manually and for working with formulas:</p>
<pre><code> worksheet:write(&quot;H1&quot;, 200)
 worksheet:write(&quot;H2&quot;, &quot;=H1+1&quot;)</code></pre>
<p>In general when using the <code>xlsxwriter</code> module you can use A1 notation anywhere you can use row-column notation.</p>
<div class="note">
<div class="title">
<p>Note</p>
</div>
<p>In Excel it is also possible to use R1C1 notation. This is not supported by <code>xlsxwriter</code>.</p>
</div>
<h2 id="abs_reference">Relative and Absolute cell references</h2>
<p>When dealing with Excel cell references it is important to distinguish between relative and absolute cell references in Excel.</p>
<p><strong>Relative</strong> cell references change when they are copied while <strong>Absolute</strong> references maintain fixed row and/or column references. In Excel absolute references are prefixed by the dollar symbol as shown below:</p>
<pre><code> A1   -- Column and row are relative.
 $A1  -- Column is absolute and row is relative.
 A$1  -- Column is relative and row is absolute.
 $A$1 -- Column and row are absolute.</code></pre>
<p>See the Microsoft Office documentation for <a href="http://office.microsoft.com/en-001/excel-help/switch-between-relative-absolute-and-mixed-references-HP010342940.aspx">more information on relative and absolute references</a>.</p>
<h1 id="cell_utility">Cell Utility Functions</h1>
<p>The <code>xlsxwriter.utility</code> module contains several helper functions for dealing with A1 notation. These functions can be imported and used as follows:</p>
<pre><code> local Utility = require &quot;xlsxwriter.utility&quot;

 cell = Utilty.rowcol_to_cell(1, 2) --&gt; C2</code></pre>
<p>The available functions are shown below.</p>
<h2 id="rowcol_to_cell">rowcol_to_cell()</h2>
<div class="function">
<p>rowcol_to_cell(row, col)</p>
<p>Convert a zero indexed row and column cell reference to a A1 style string.</p>
<dl>
<dt>param row</dt>
<dd><p>The cell row.</p>
</dd>
<dt>param col</dt>
<dd><p>The cell column.</p>
</dd>
<dt>rtype</dt>
<dd><p>A1 style string.</p>
</dd>
</dl>
</div>
<p>The <code>rowcol_to_cell()</code> function converts a zero indexed row and column cell values to an <code>A1</code> style string:</p>
<pre><code> cell = Utilty.rowcol_to_cell(0, 0) --&gt; A1
 cell = Utilty.rowcol_to_cell(0, 1) --&gt; B1
 cell = Utilty.rowcol_to_cell(1, 0) --&gt; A2</code></pre>
<h2 id="rowcol_to_cell_abs">rowcol_to_cell_abs()</h2>
<div class="function">
<p>rowcol_to_cell_abs(row, col[, row_abs, col_abs])</p>
<p>Convert a zero indexed row and column cell reference to a A1 style string.</p>
<dl>
<dt>param row</dt>
<dd><p>The cell row.</p>
</dd>
<dt>param col</dt>
<dd><p>The cell column.</p>
</dd>
<dt>param row_abs</dt>
<dd><p>Optional flag to make the row absolute.</p>
</dd>
<dt>param col_abs</dt>
<dd><p>Optional flag to make the column absolute.</p>
</dd>
<dt>rtype</dt>
<dd><p>A1 style string.</p>
</dd>
</dl>
</div>
<p>The <code>rowcol_to_cell_abs()</code> function is like the <code>rowcol_to_cell_abs()</code> function but the optional parameters <code>row_abs</code> and <code>col_abs</code> can be used to indicate that the row or column is absolute:</p>
<pre><code> str = Utilty.rowcol_to_cell_abs(0, 0, false, true) --&gt; $A1
 str = Utilty.rowcol_to_cell_abs(0, 0, true       ) --&gt; A$1
 str = Utilty.rowcol_to_cell_abs(0, 0, true,  true) --&gt; $A$1</code></pre>
<h2 id="cell_to_rowcol">cell_to_rowcol()</h2>
<div class="function">
<p>cell_to_rowcol(cell_str)</p>
<p>Convert a cell reference in A1 notation to a zero indexed row and column.</p>
<dl>
<dt>param cell_str</dt>
<dd><p>A1 style string, absolute or relative.</p>
</dd>
<dt>rtype</dt>
<dd><p>row, col.</p>
</dd>
</dl>
</div>
<p>The <code>cell_to_rowcol()</code> function converts an Excel cell reference in <code>A1</code> notation to a zero based row and column. The function will also handle Excel"s absolute cell notation:</p>
<pre><code> row, col = Utilty.cell_to_rowcol(&quot;A1&quot;)   --&gt; (0, 0)
 row, col = Utilty.cell_to_rowcol(&quot;B1&quot;)   --&gt; (0, 1)
 row, col = Utilty.cell_to_rowcol(&quot;C2&quot;)   --&gt; (1, 2)
 row, col = Utilty.cell_to_rowcol(&quot;$C2&quot;)  --&gt; (1, 2)
 row, col = Utilty.cell_to_rowcol(&quot;C$2&quot;)  --&gt; (1, 2)
 row, col = Utilty.cell_to_rowcol(&quot;$C$2&quot;) --&gt; (1, 2)</code></pre>
<h2 id="col_to_name">col_to_name()</h2>
<div class="function">
<p>col_to_name(col[, col_abs])</p>
<p>Convert a zero indexed column cell reference to a string.</p>
<dl>
<dt>param col</dt>
<dd><p>The cell column.</p>
</dd>
<dt>param col_abs</dt>
<dd><p>Optional flag to make the column absolute.</p>
</dd>
<dt>rtype</dt>
<dd><p>Column style string.</p>
</dd>
</dl>
</div>
<p>The <code>col_to_name()</code> converts a zero based column reference to a string:</p>
<pre><code> column = Utilty.col_to_name(0)   --&gt; A
 column = Utilty.col_to_name(1)   --&gt; B
 column = Utilty.col_to_name(702) --&gt; AAA</code></pre>
<p>The optional parameter <code>col_abs</code> can be used to indicate if the column is absolute:</p>
<pre><code> column = Utilty.col_to_name(0, false) --&gt; A
 column = Utilty.col_to_name(0, true)  --&gt; $A
 column = Utilty.col_to_name(1, true)  --&gt; $B</code></pre>
<h2 id="range">range()</h2>
<div class="function">
<p>range(first_row, first_col, last_row, last_col)</p>
<p>Converts zero indexed row and column cell references to a A1:B1 range string.</p>
<dl>
<dt>param first_row</dt>
<dd><p>The first cell row.</p>
</dd>
<dt>param first_col</dt>
<dd><p>The first cell column.</p>
</dd>
<dt>param last_row</dt>
<dd><p>The last cell row.</p>
</dd>
<dt>param last_col</dt>
<dd><p>The last cell column.</p>
</dd>
<dt>rtype</dt>
<dd><p>A1:B1 style range string.</p>
</dd>
</dl>
</div>
<p>The <code>range()</code> function converts zero based row and column cell references to an <code>A1:B1</code> style range string:</p>
<pre><code> cell_range = Utilty.range(0, 0, 9, 0) --&gt; A1:A10
 cell_range = Utilty.range(1, 2, 8, 2) --&gt; C2:C9
 cell_range = Utilty.range(0, 0, 3, 4) --&gt; A1:E4</code></pre>
<h2 id="range_abs">range_abs()</h2>
<p>The <code>range_abs()</code> function converts zero based row and column cell references to an absolute <code>$A$1:$B$1</code> style range string:</p>
<pre><code> cell_range = Utilty.range_abs(0, 0, 9, 0) --&gt; $A$1:$A$10
 cell_range = Utilty.range_abs(1, 2, 8, 2) --&gt; $C$2:$C$9
 cell_range = Utilty.range_abs(0, 0, 3, 4) --&gt; $A$1:$E$4</code></pre>
