<h2 id="local-uri-requireuri"><code>local uri = require'uri'</code></h2>
<p>URI parsing and formatting.</p>
<h2 id="api">API</h2>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>uri.format(t) -&gt; s</code></td>
<td style="text-align: left;">format URI</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>uri.parse(s) -&gt; t</code></td>
<td style="text-align: left;">parse URI</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>uri.escape(s[,res][,unres]) -&gt; s</code></td>
<td style="text-align: left;">escape URI fragment</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>uri.unescape(s) -&gt; s</code></td>
<td style="text-align: left;">unescape URI fragment</td>
</tr>
</tbody>
</table>
<h3 id="uri.formatt---s"><code>uri.format(t) -&gt; s</code></h3>
<p>Format a URI from a table containing the fields: <code>scheme</code>, <code>user</code>, <code>pass</code>, <code>host</code>, <code>port</code>, <code>path</code> or <code>segments</code>, <code>query</code> or <code>args</code>, and <code>fragment</code>.</p>
<p>If the field <code>segments</code> is present, it will be used instead of <code>path</code> to format the path part of the URI. It must be a list of strings representing the path segments, with the advantage that each segment can contain slashes which will be properly encoded.</p>
<p>If the field <code>args</code> is present, it will be used instead of <code>query</code> to format the query part of the URI with the advantage that arg keys and values can contain the characters <code>&amp;</code>, <code>=</code>, <code>?</code>, <code>#</code> which will be properly encoded. The args can be given as a list of form <code>{key1, value1, ...}</code> or as a table of form <code>{key -&gt; value}</code>. The first form allows duplicate keys and preserves key order while the map form lays out the keys alphabetically. Values can be tostringables, <code>true</code> to format only the key without <code>=</code> or <code>false</code> to ignore the key.</p>
<h3 id="uri.parses---t"><code>uri.parse(s) -&gt; t</code></h3>
<p>Parse a URI of the form <code>[scheme:](([//[user[:pass]@]host[:port][/path])|path)[?query][#fragment]</code> into its components. The fields <code>segments</code> and <code>args</code> are present too, and have the same meaning as for <code>uri.format</code> above (the <code>args</code> table will have both its array part and its hash part populated).</p>
<p>Some edge cases and how theyâ€™re handled:</p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>foo?a=b&amp;a=c</code></td>
<td style="text-align: left;"><code>{path='foo', args={a='c', 'a', 'b', 'a', 'c'}}</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>foo?a=</code></td>
<td style="text-align: left;"><code>{path='foo', args={a='', 'a', ''}}</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>foo?=b</code></td>
<td style="text-align: left;"><code>{path='foo', args={[''] = 'b', '', 'b'}}</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>foo?a</code></td>
<td style="text-align: left;"><code>{path='foo', args={a=true, 'a', true}}</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>foo?=</code></td>
<td style="text-align: left;"><code>{path='foo', args={[''] = '', '', ''}}</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>foo?</code></td>
<td style="text-align: left;"><code>{path='foo', args={[''] = true, '', true}}</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>foo</code></td>
<td style="text-align: left;"><code>{path='foo'}</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note that <code>://:@/?#</code> is a valid URL.</p>
</blockquote>
<h3 id="uri.escapesreservedunreserved---s"><code>uri.escape(s[,reserved][,unreserved]) -&gt; s</code></h3>
<p>Escape all characters except the URI spec <code>unreserved</code> and <code>sub-delims</code> characters, and the characters in the unreserved list, plus the characters in the reserved list, if any.</p>
<h3 id="uri.unescapes---s"><code>uri.unescape(s) -&gt; s</code></h3>
<p>Unescape escaped characters in the URI.</p>
